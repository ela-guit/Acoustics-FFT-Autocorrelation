\documentclass[12pt]{article}
\usepackage{titlesec}
\usepackage[super]{natbib}
%indents
\usepackage[top = 2cm, bottom = 2cm, left = 3cm, right = 3cm]{geometry}
%don't label equations
\usepackage{amsmath}
%can use \therefore
\usepackage{amssymb}
\usepackage[super]{natbib}
\usepackage{graphicx}
\usepackage{float}
\usepackage[font=footnotesize,labelfont=bf]{caption}

%section header formatting
\titleformat*{\section}
	{\large\sffamily\bfseries}
\titleformat*{\subsection}
	{\sffamily\bfseries}
\titleformat*{\subsubsection}
	{\sffamily\bfseries}


\title{\sf{\textbf{Applying the Fourier Transform and Autocorrelation to Sound}}}
\date{December, 2017}
\author{Adam Gao}

\begin{document}

\maketitle

\section{Introduction}

Sound is a wave. A wave has characteristics in both frequency and variation over time, which can be analyzed computationally.\newline

Tohyama emphasizes the categorization of formulation between temporal and spectral characteristics of sound throughout his book \textit{Waveform Analysis of Sound} and a la chapter titles 'Temporal and Spectral Characteristics of Sequence' and 'Temporal and Spectral Enhancement by Sound Path'.\citep{aa} His book formulates different techniques applied to waveform analysis of sound. A combination of the auto-correlation and the fast fourier transform helps analyze these characteristics in both the time and frequency domain. In certain situations, the auto-correlation sequence can get frequency information that the fourier transform cannot, despite its traditional use, as will be explored.

\section{Mathematical Methods}

\subsection{Sound as a sequence:}

Raw sound is a function over a continuous time domain. For methods of analysis in the temporal domain to be applied, sound data must be taken as a discrete sequence instead.\citep{aa} For the purpose of this project, such methods are largely referenced from \textit{Waveform Analysis of Sound} by Mikio Tohyama, where sound is indeed taken to be a discrete sequence.\citep{aa} \newline

Sound as discrete sequences will generally be denoted as a function $x(n)$, with respect to the sequence number $n$.

\subsection{Fourier Transform (brief introduction)}

Briefly speaking, a waveform can be expressed as a summation of eigenfunctions of different frequencies. The fourier transform of a sequence returns a new sequence in the spectral domain, where each element of the sequence is a coefficient corresponding to a frequency, in increasing order of frequencies.\newline

Tohyama defines a transform more generalized than the fourier transform, called a z-transform.\citep{aa} The z-transform converts a time domain into a frequency domain and the fourier transform parameterizes the z-transform on to a unit circle with expression $e^{i\Omega}$, where $\Omega$ denotes a normalized angular frequency.\citep{aa} In other words, $e^{i\Omega}$ is the eigenfunction of the fourier transform.\newline

Denote the z transform of a sequence $a(n)$ as follows\citep{aa}

\begin{equation}
A(z^{-1}) = \sum\limits_{n} a(n)z^{-n} \label{z transform}
\end{equation}

The fourier-transform takes different forms and notations. For general purposes, denote the fourier-transform of a sequence $a(n)$ as  $A(e^{-i\Omega})$.



\subsection{Fourier Transform (phase and maginitude)}

It is important to note that the full imaginary form of the fourier transform is used in mathematical formulation, with the real part corresponding to an even function and the imaginary part corresponding to an odd function. Differentiating between the real and imaginary fourier transform will be relevant to later discussion in wave analysis.

\subsection{Cross-correlation, Autocorrelation:}

\textit{Cross-correlation} quantifies similarity between two sequences at different amounts of displacement between said sequences.\newline

The cross-correlation sequence $r_c(n)$ between two sequences $a(n)$ and $b(n)$ are defined by the following equation\citep{aa}

\begin{equation}
r_c(n)= a \bigotimes b(n) = \sum\limits_{m} a(m)b(m-n)\label{eq:cross-correlation}
\end{equation}

The auto-correlation $r_a(n)$ of a sequence $a(n)$ is the cross-correlation between $a(n)$ and itself. Thus, the auto-correlation is defined as follows\citep{aa}

\begin{equation}
r_a(n) = a \bigotimes a(n) = \sum\limits_{m} a(m)a(m-n)\label{eq:auto-correlation}
\end{equation}

\subsection{Convolution:}

Tohyama introduces convolution before he does cross-correlation. This is because cross-correlation can be expressed in terms of convolution.\citep{aa}\newline

Roughly speaking, convolution is the measure of how different two sequences are at different distances. As the interest of the discussed waveform analysis only relates to convolution as convolution rates to cross-correlation, I will simply express the cross-correlation sequence with respect to the convolution sequence.

Denote the convolution sequence between $a(n)$ and $b(n)$ as $a*b(n)$.

Then \citep{aa}:

\begin{equation}
a \bigotimes b(n) = a * b(-n)\label{eq:convolution}
\end{equation}

\section{Waveform Analysis}

\subsection{Magnitude and Phase of Spectrum}

The auto-correlation sequence $r(n)$ of $x(n)$ can be expressed in terms of the power spectral density of $x(n)$ as follows\citep{aa}:

\begin{equation}
R(e^{-i\Omega}) = X(e^{-i\Omega})X(e^{i\Omega}) = |X(e^{-i\Omega})|^2
\label{autocorrelation power spectrum}
\end{equation}

Because the power spectral density is even, the auto-correlation sequence is even. Thus, given a (purely) even sequence (Tohyama calls this null-phase spectrum), auto-correlation is not particularly useful\citep{aa}.\newline

Nonetheless, Tohyama states 'The auto-correlation, however, is useful for period analysis of a sequence''\citep{aa}. In essence, he shows that auto-correlation reveals frequency information that the fast fourier transform may not.\newline

First, Tohyama denotes a periodic sequence of period N as follows \citep{aa}:

\begin{equation}
x(n) = x(n + pN)\label{periodic sequence}
\end{equation}

where $p$ is an integer.

Tohyama then states that the sequence can be written as the convolution between a single cycle of the sequence $x_0$ and a unit pulse train $u(n)$ as follows:

\begin{equation}
u(n) = x_0 * u(n)
\label{single cycle train}
\end{equation}

with the unit-pulse train defined as follows\citep{aa}:

\begin{equation}
u(n) = \sum\limits_{p} \delta (n-pN)
\label{unit pulse}
\end{equation}

Tohyama then expresses the z-transform of the periodic sequence as follows \cite{aa}:

\begin{equation}
X(z^{-1}) = X_0(z^{-1})U(z^{-1}) = X_0(z^{-1})\delta(z^{-N}-1)\label{auto 1}
\end{equation}

Squaring both sides, Tohyama argues that \cite{aa}:

\begin{equation}
|X(e^{-i\Omega})|^{2}\Delta\Omega = P_{0s}(e^{-i\Omega})\label{auto 2}
\end{equation}

Finally, using \label{autocorrelation power spectrum} the autoccorrelation can be expressed \cite{aa}:



\begin{equation}
r(n) = {1/{2\pi}}\int_{0}^{2\pi}|X_0(e^{-i\Omega})|^2\delta(e^{-i\Omega}-1)e^{i\Omega}d\Omega = \sum_{k=0}^{N-1}P_0(e^{-i2{\pi}k/N})cos({2{\pi}kn/N})\label{auto 3}
\end{equation}

Tohyama uses equation \ref{auto 3} to argue that 'the autocorrelation is also periodic with period N'\cite{aa}. He states 'the auto-corrrelation sequence composed of zero-phase spectral components takes its maximum always at $n = 0$, and thus helps to estimate the fundamental period more easily.'\cite{aa} What this means is that the auto-correlation sequence being an even function is maximum at 0 path difference, which helps estimate the fundamental period more easily.

\subsection{Triangular Windowing}

Because frequency information is time dependent, frame-wise auto-correlations are useful. Tohyama essentially states that as time lag increases, variance increases\cite{aa}. He proceeds to state that triangular windowing can decrease these effects.\cite{aa}

\subsection{Single Sound Reflection}


Different methods can be computationally applied to analyze reflection of sound.\newline

\textbf{Square averages and Auto-correlation:}

Assuming a time sequence is the superposition of a direct sound and its reflection, its square average should depend on the cross-correlation between the direct sound and reflection sequences.\cite{aa} Tohyama denotes a direct sound $s_d(n)$ and its reflection $s_r(n) = s_d(n-m)$\cite{aa}. Thus a perfect reflection should simply be the perfect source with a discretized time translation, $m$. Assuming a perfect reflection, Tohyama relates the square average to the auto-correlation of the direct sound as follows, where $E[*]$ denotes ensemble average and $r_d(m)$ denotes the auto-correlation of the direct sound:

\begin{equation}
E[(s_d(n) + s_d(n-m))^2] = E[s^2_d(n)] + E[s^2_d(n-m) + 2r_d(m)\label{squareaverage}
\end{equation}

\section{Computational Application}

\subsection{Code Summary}

The python code has been modularized into multiple files.\newline

Files starting with "Waveforms" include functions and sequences to be imported.\newline

"Waveforms.py", generates different waveforms as sequences to be analyzed.\newline

"Waveforms2.py" consists of actual sound samples data, including the sound pressure information as sequences over the temporal domain, as well as the the sound file sampling rates.\newline

"Waveforms3.py" consists of a function which generates waveforms using frequency information. The function sineharmonics takes a list of different harmonic numbers and sums sinewaves corresponding to each harmonic, over the temporal domain. The new sequence can then be analyzed as a waveform over the temporal domain.

\subsection{Python packages}

All code has been typed in python.\newline

\subsubsection{Cross-correlation}

The function "numpy.correlate" from the numpy package of python may be used to return the cross-correlation of an input sequence.\cite{ab}

numpy.correlate has multiple modes: "valid", "same" and "full" which determines the array length. "valid" returns an array length of 1.\cite{ab} "same" returns an array of length equal to the length of the argument array.\cite{ab} "full" returns the full cross-correlation between all possible distances (negative and positive).\cite{ab}

\subsubsection{Fourier Transform}

The function "numpy.fft.rfft" uses the fast fourier transform algorithm to take the discrete fourier transform of a real array.\cite{ab} This is most relevant to waveform analysis since the sound waves are of real values.\newline

The notes on the scipy website state that "the negative frequency terms are just the complex conjugates of the corresponding positive-frequency terms, and the negative-frequency terms are therefore redundant."\cite{ab} This means that taking the absolute square of the fourier transform would provide invalid power spectra. Rather, one should either just ignore the negative terms, or remove them in the graph.

\subsubsection{Triangular Window}

The function "scipy.signal.triang" from the scipy package returns an triangular window in the form of an array\cite{ab}. A triangular window is a linear function that is reflected across the middle of the x axis, forming a "triangle". By multiplying an array by the triangular window, it seems that one can decrease the importance of temporal information at the boundaries of the frame. The following is a graphic of a triangular window plot from the scipy website:

\begin{figure}[h]
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"Triangular window scipy".png}
	\caption{Triangular window taken from scipy website\cite{ab}}
	\endminipage\hfill
\end{figure}

\section{Results and Discussion}

\subsection{Auto-correlation Properties: Unit Pulse Trains}

The file "auto-correlation properties.py" tests the principle of equation \ref{single cycle train}, where a sine wave of multiple cycles is equivalent to the convolution between a unit pulse train of an equal amount of cycles and the sine wave for one cycle. The implication is that the auto-correlation sequence is effective at revealing fundamental frequency information.

\begin{figure}[H]
	\minipage{0.5\linewidth}
    \includegraphics[width=\linewidth]{"Unit pulse train".png}
    \caption{Unit pulse train}\label{Unit pulse train}
    \endminipage\hfill
    \minipage{0.5\linewidth}
    \includegraphics[scale=0.4]{"Single Cycle Sine Wave".png}
    \caption{Sine wave of a single cycle}\label{Single Cycle Sine Wave}
    \endminipage\hfill
    \minipage{0.5\linewidth}
    \includegraphics[scale=0.4]{"Convolution vs Full sequence 1".png}
    \caption{Convolution vs Full sequence, sine wave}\label{Convolution vs Full sequence 1}
    \endminipage\hfill
\end{figure}

Figure \ref{Unit pulse train} shows a unit pulse train of period 10. Every 10 indexes the function returns 1, and in all other indexes the function returns 0.\newline

Figure \ref{Single Cycle Sine Wave} shows a sine wave of a single cycle, also of period 10.\newline

Figure \ref{Convolution vs Full sequence 1} shows the convolution between the unit pulse train and the single cycle sine wave. Figure \ref{Convolution vs Full sequence 1} also shows the same sine wave of period 10 plotted over multiple cycles.\newline

As consistent with equation \ref{single cycle train}, in Figure \ref{Convolution vs Full sequence 1}, the convolution sequence and the directly plotted sine wave are identical, with an offset in the argument domain, which can be attributed to the location of the first spike in the unit pulse train.\newline

Of course, knowing fundamental frequency of a sine wave is trivial. However, if this result can be generalized to other waveforms, then fundamental frequency information should also be clear for other waveforms. Thus, the convolution between a waveform consisting of multiple harmonics and the same unit pulse train was observed.

\begin{figure}[H]
	\minipage{0.5\linewidth}
    \includegraphics[width=\linewidth]{"Single Cycle Multiple Harmonics".png}
    \caption{Single Cycle Multiple Harmonics}\label{Single Cycle Multiple Harmonics}
    \endminipage\hfill
    \minipage{0.5\linewidth}
    \includegraphics[scale=0.4]{"Convolution vs Full sequence 2".png}
    \caption{Convolution vs Full sequence, multiple harmonics}\label{Convolution vs Full sequence 2}
    \endminipage\hfill
\end{figure}

Figure \ref{Single Cycle Multiple Harmonics} shows a signal generated using harmonic numbers from Waveforms3.py. The signal is composed of harmonics 1 through 20. The coefficient of each sine wave decreases as the harmonic number increases. This is to smooth the function. The lowest harmonic is the fundamental frequency and determines the period of the overall waveform.\newline

Figure \ref{Convolution vs Full sequence 2} shows the convolution between the waveform in figure \ref{Single Cycle Multiple Harmonics} and the unit pulse train in figure \ref{unit pulse}. Figure \ref{Convolution vs Full sequence 2} also shows the waveform in \ref{Single Cycle Multiple Harmonics} over multiple cycles. The two waveforms appear very similar. Thus, the auto-correlation sequence as argued for in \ref{auto 3} should be able to reveal fundamental frequency information.

\subsection{Single Sound Reflection}

Briefly speaking, an attempt at confirming equation \ref{squareaverage} was made for a sine wave superposed over a delayed instance of itself. This was done in sound\_reflection.py.

\begin{figure}[H]
	\minipage{0.5\linewidth}
    \includegraphics[width=\linewidth]{"Reflection sequences".png}
    \caption{Waveform to be analyzed with respect to equation \ref{squareaverage}}\label{Reflection waveform}
    \endminipage\hfill
    \minipage{0.5\linewidth}
    \includegraphics[scale=0.4]{"Reflection equation".png}
    \caption{Comparison between left side and right side of equation \ref{squareaverage}} of figure \ref{Reflection waveform}\label{Reflection equation}
    \endminipage\hfill
\end{figure}

Figure \ref{Reflection waveform} shows the sequence being analyzed and figure \ref{Reflection equation} shows the effective left hand sides and right hand sides of equation \ref{squareaverage} as sequences. The ensemble average of the sequence was interpreted to be the exact sequence, since there is only one instance of a waveform.

Essentially, the two sides of the equation did not equate for the entire sequence. The auto-correlation term on the right hand side dominated the entire term, being much greater than the square of the other sequences for all indexes.

This attempt was not very fruitful and I found it a much better use of time to explore other aspects of waveform analysis as applied to acoustics.

\subsection{Effect of Harmonics on Auto-Correlation}

The value of auto-correlation in getting fundamental frequency information was tested using generated waveforms imported from Waveforms3.py, in the file 'sound\_fundamental\_frequency.py'.

\begin{figure}[H]
	\minipage{0.5\linewidth}
    \includegraphics[width=\linewidth]{"Signal A1".png}
    \caption{Signal A1}\label{Signal A1}
    \endminipage\hfill
    \minipage{0.5\linewidth}
    \includegraphics[scale=0.4]{"Signal A2".png}
    \caption{Signal A2}\label{Signal A2}
    \endminipage\hfill
    \minipage{0.5\linewidth}
    \includegraphics[scale=0.4]{"Signal A3".png}
    \caption{Signal A3}\label{Signal A3}
    \endminipage\hfill
\end{figure}

Figures \ref{Signal A1}, \ref{Signal A2}, and \ref{Signal A3} show different signals generated using harmonic numbers. Their respective plot bins (temporal domains) have units kept in terms of bin number, rather than argument value for the sine functions. This is for ease of comparison with the auto-correlation sequences.\newline

Figure \ref{Signal A1} shows Signal A1, a signal composed of harmonics 1 through 20. The coefficient of each sine wave decreases as the harmonic number increases. Signal A1 is identical in form to the previously generated wave in figure \ref{Single Cycle Multiple Harmonics}. Thus, as was true in the previous unit pulse train study, the lowest harmonic is the fundamental frequency and determines the period of the overall waveform.\newline

Figure \ref{Signal A2} shows Signal A2, which is Signal A1 with the first harmonic removed. Effectively, Signal A2 is Signal A1 without its fundamental frequency. One can observe that A2 retains a similar periodic behavior as A1, with obvious spikes of same period as in A1. Only waveform has changed.\newline

Figure \ref{Signal A3} shows Signal A3, which is Signal A1 with the first five harmonics removed. Even so, fundamental frequency information is still very obvious and consistant with A2.

\begin{figure}[H]
	\minipage{0.5\linewidth}
    \includegraphics[width=\linewidth]{"Signal A1 auto-correlation".png}
    \caption{Signal A1 auto-correlation}\label{Signal A1 aa}
    \endminipage\hfill
    \minipage{0.5\linewidth}
    \includegraphics[scale=0.4]{"Signal A2 auto-correlation".png}
    \caption{Signal A2 auto-correlation}\label{Signal A2 aa}
    \endminipage\hfill
    \minipage{0.5\linewidth}
    \includegraphics[scale=0.4]{"Signal A3 auto-correlation".png}
    \caption{Signal A3 auto-correlation}\label{Signal A3 aa}
    \endminipage\hfill
\end{figure}

Figures \ref{Signal A1 aa}, \ref{Signal A2 aa}, and \ref{Signal A3 aa} show the full auto-correlation sequences for each of their respective signals. The maximum value of the auto correlation sequence is at the center of the domain for all signals. This means that distance is located at the center of each signal's domain.\newline

It is clear that fundamental frequency information is similarly preserved for auto-correlation sequences of all signals.\newline

However, since fundamental frequency information is quite obvious from the raw signals, in this case the auto-correlation sequences are redundant in usage, though clearly effective.

\begin{figure}[H]
	\minipage{0.5\linewidth}
    \includegraphics[width=\linewidth]{"Harmonic Numbers".png}
    \caption{Harmonic Number information}\label{Harmonic Numbers}
    \endminipage\hfill
	\minipage{0.5\linewidth}
    \includegraphics[width=\linewidth]{"Signal A1 fft".png}
    \caption{Signal A1 fourier transform}\label{Signal A1 fft}
    \endminipage\hfill
    \minipage{0.5\linewidth}
    \includegraphics[width=\linewidth]{"Signal A2 fft".png}
    \caption{Signal A2 fourier transform}\label{Signal A2 fft}
    \endminipage\hfill
    \minipage{0.5\linewidth}
    \includegraphics[width=\linewidth]{"Signal A3 fft".png}
    \caption{Signal A3 fourier transform}\label{Signal A3 fft}
    \endminipage\hfill
\end{figure}

Figure \ref{Harmonic Numbers} displays the amplitude of each harmonic number graphed with respect to the harmonic number. This information was directly used to generate the analyzed waveforms A1, A2, and A3.\newline

Figures \ref{Signal A1 fft}, \ref{Signal A2 fft}, \ref{Signal A3 fft} display the fast fourier transforms of each respective signal using np.fft.rfft. There are 19 equally spaced peaks corresponding to each harmonic in \ref{Signal A1 fft} as expected (the 20th harmonic has a coefficient of 0). In figures \ref{Signal A2 fft} and \ref{Signal A3 fft}, the respective harmonics are missing, as expected. This means that the fourier transform is not as helpful for finding the fundamental frequency in signals A2 and A3.\newline

Contrary to what is expected, the amplitudes of the peaks are not proportionally aligned to what is shown in figure \ref{Harmonic Numbers}. In other words, the fourier transforms imply different coefficients for the harmonics, for all signals. This means that frequency information in the fast fourier transform algorithm is distorted, that the amplitude of one frequency is distorted by the existence of other frequencies. This is to say that a single sine wave has a fast fourier transform corresponding to its harmonic information, but waveforms A1, A2, and A3 do not.

\subsection{Reverbated Speech}

Speech samples from Mc Squared System Design Group, Inc were analyzed\cite{ac}. As stated on the company website, The sound files were "constructed by Wade McGregor using Sound Forge software"\cite{ac}.\newline

Two sound files were analyzed in 'sound\_speech.py'. They are identical speech samples
in situations of different reverberations (echo levels). The speech sample with no reverb will be referred to as dry speech. The speech sample with 2 seconds of reverb will simply be referred to as the reverberated sample.\newline

Frames of several milliseconds were taken from the sound files so that auto-correlation sequences could be taken. They were processed through a triangular window before the auto-correlation sequences were taken.

\begin{figure}[H]
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"Dry speech sample".png}
	\caption{Dry speech sample}\label{Dry speech sample}
	\endminipage\hfill
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"Reverbated speech sample".png}
	\caption{Reverberated speech sample}\label{Reverbated speech sample}
	\endminipage\hfill
\end{figure}

Figures \ref{Dry speech sample} and \ref{Reverbated speech sample} show plots of the soundwaves over the temporal domain as extracted from the sound files, for dry speech and reverberated speech respectively. Additionally, the frames that were taken and analyzed as temporal sequences are highlighted. The highlighted parts are very small, as the frames must be short. If the frames are too long, the frequency information will vary too much for any meaningful information to be extracted.\cite{aa} Also, the reverberated sample is longer than the dry sample. This is probably to account for the sound of the echoes in the reverberated sample.

\begin{figure}[H]
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"AA Frame 1 ntr".png}
	\caption{Auto-correlation of frame 1, dry, raw}\label{AA Frame 1 ntr}
	\endminipage\hfill
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"AA Frame 2 ntr".png}
	\caption{Auto-correlation of frame 2, dry, raw}\label{AA Frame 2 ntr}
	\endminipage\hfill
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"AA Frame 3 ntr".png}
	\caption{Auto-correlation of frame 3, dry, raw}\label{AA Frame 3 ntr}
	\endminipage\hfill
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"AA R Frame 1 ntr".png}
	\caption{Auto-correlation of frame 1, reverb, raw}\label{AA R Frame 1 ntr}
	\endminipage\hfill
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"AA R Frame 2 ntr".png}
	\caption{Auto-correlation of frame 2, reverb, raw}\label{AA R Frame 2 ntr}
	\endminipage\hfill
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"AA R Frame 3 ntr".png}
	\caption{Auto-correlation of frame 3, reverb raw}\label{AA R Frame 3 ntr}
	\endminipage\hfill
\end{figure}

Figures \ref{AA Frame 1 ntr} through \ref{AA R Frame 3 ntr} show the auto-correlation sequences of the direct frames with out being temporally filtered through a triangular window. The sequences all seem rather erratic.

\begin{figure}[H]
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"Triangularization Frame 1 dry speech".png}
	\caption{Frame 1 of Dry speech sample}\label{Triangularization Frame 1 dry speech}
	\endminipage\hfill
\end{figure}

Figure \ref{Triangularization Frame 1 dry speech} shows the triangular windowed and the non-windowed versions of the raw soundwave in frame 1 of the dry speech sample. On a qualitative level, one cannot discern any meaningful frequency information from the speech sample shape. A human voice is a complex arangement of frequencies, after all. It seems that triangular windowing decreases information near the boundaries. In theory, this allows the auto-correlation sequence to be effectively used.

\begin{figure}[H]
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"AA Frame 1 tr".png}
	\caption{Auto-correlation of frame 1, dry, windowed}\label{AA Frame 1 tr}
	\endminipage\hfill
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"AA Frame 2 tr".png}
	\caption{Auto-correlation of frame 2, dry, windowed}\label{AA Frame 2 tr}
	\endminipage\hfill
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"AA Frame 3 tr".png}
	\caption{Auto-correlation of frame 3, dry,  windowed}\label{AA Frame 3 tr}
	\endminipage\hfill
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"AA R Frame 1 tr".png}
	\caption{Auto-correlation of frame 1, reverb, windowed}\label{AA R Frame 1 tr}
	\endminipage\hfill
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"AA R Frame 2 tr".png}
	\caption{Auto-correlation of frame 2, reverb, windowed}\label{AA R Frame 2 tr}
	\endminipage\hfill
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"AA R Frame 3 tr".png}
	\caption{Auto-correlation of frame 3, reverb windowed}\label{AA R Frame 3 tr}
	\endminipage\hfill
\end{figure}

Figures \ref{AA Frame 1 tr} to \ref{AA R Frame 3 tr} show the auto-correlations of the triangular windowed frames in the speech samples. Frequency information is discernible even on a qualitative level. There are clear sinusoidal oscillations particularly in figures \ref{AA Frame 2 tr} and \ref{AA R Frame 3 tr}. Wherever the period of the oscillations are too large for a fundamental frequency to be discernible, most likely the frame is too short and needs to be increased in size.\newline

Theoretically, if the dry sample and reverberated samples begin at the same exact time, the triangular windowed autocorrelations for the dry sample and reverberated samples should not differ much in fundamental frequency information, assuming identical frame locations, even under heavy reverb\cite{aa}. This explains why the human ear can discern speech under heavy reverb conditions\cite{aa}.\newline

Comparing the most frames with the most concrete frequency information, frame 2, between the dry and reverberated speech samples, it seems that the frequencies are not proportionally equal with respect to the frame lengths. Frame 2 for dry speech (figure \ref{AA Frame 2 tr}) is half as long as frame 2 for reverberated speech (figure \ref{AA R Frame 2 tr}), implying that the oscillations for the dry speech graph should visually be half as long in length as that for the reverberated speech graph, such that the fundamental frequencies are equal. This is clearly not true, which means that the two speech samples must begin at different times.

\begin{figure}[H]
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"FFT Frame 1".png}
	\caption{Frequency spectrum of frame 1, dry speech}\label{FFT Frame 1}
	\endminipage\hfill
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"FFT Frame 2".png}
	\caption{Frequency spectrum of frame 2, dry speech}\label{FFT Frame 2}
	\endminipage\hfill
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"FFT Frame 3".png}
	\caption{Frequency spectrum of frame 3, dry speech}\label{FFT Frame 3}
	\endminipage\hfill
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"FFT R Frame 1".png}
	\caption{Frequency spectrum of frame 1, reverberated speech}\label{FFT R Frame 1}
	\endminipage\hfill
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"FFT R Frame 2".png}
	\caption{Frequency spectrum of frame 2, reverberated speech}\label{FFT R Frame 2}
	\endminipage\hfill
	\minipage{0.5\linewidth}
	\includegraphics[width=\linewidth]{"FFT R Frame 3".png}
	\caption{Frequency spectrum of frame 3, reverberated speech}\label{FFT R Frame 3}
	\endminipage\hfill
\end{figure}

Figures \ref{FFT Frame 1} through \ref{FFT R Frame 3} show the frequency information calculated from taking the absolute squared values of the fourier transforms of the frames. While the negative values of the real fourier transforms are redundant, they should not distort the power spectra. The fourier transform is indeed useful in getting frequency information as well, since figure \ref{FFT Frame 2} and \ref{FFT R Frame 3} have discernible spikes much beyond the lowest frequency, corresponding to the visually discernible frequencies in the auto-correlation sequences. However, in all the fourier transform plots there are other spikes as well corresponding to other frequencies. Thus, auto-correlation is a useful tool to be used with the fourier-transform to discern important frequency information.

\subsection{Testing/Benchmarking}

Effectively, using the auto-correlation sequence to test generated waveforms of different harmonics served to confirm that the auto-correlation function was being applied correctly. By confirming that fundamental frequency information was correctly obtained for waveforms where the frequencies could be controlled, it can be safely assumed that the same conditions apply to speech analysis.\newline

While the convolution between different waveforms and unit pulse trains were not effectively test-cases for the auto-correlation sequence, they did help benchmark the effectiveness of auto-correlation usage to analyze frequency information for a signal of different harmonics, specifically "signal A1" in figure \ref{Signal A1 aa}.

\subsection{Error Analysis and Conclusions}

Wherever there was trouble using the fourier-transform, the auto-correlation sequence helped. Fundamental frequency information is  complex in nature and relevant research is largely subjected to what the human ear can discern\citep{aa}. Thus, error cannot be directly quantified. However, at several points, particularly in the analysis of generated waveforms as was done in figure \ref{Signal A3 aa}, and in the speech analysis, the auto-correlation provided very clear frequency information. Variance affects the data particularly in speech analysis as the time domain becomes long. While error was not an issue in the generated waveforms, in the case of human speech where frequency information varies rapidly, the analysis of frequencies both through fourier transforms and auto-correlation were heavily affected.

\bibliographystyle{chicago}
\bibpunct{}{}{,}{s}{,}{,}
\medskip
\bibliography{wavebib}
\end{document}
